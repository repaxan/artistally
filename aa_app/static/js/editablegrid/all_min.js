function _$(e){return document.getElementById(e)}function Column(e){var t={name:"",label:"",editable:!0,renderable:!0,datatype:"string",unit:null,precision:-1,nansymbol:"",decimal_point:",",thousands_separator:".",unit_before_number:!1,bar:!0,hidden:!1,headerRenderer:null,headerEditor:null,cellRenderer:null,cellEditor:null,cellValidators:[],enumProvider:null,optionValues:null,optionValuesForRender:null,columnIndex:-1};for(var r in t)this[r]="undefined"==typeof e||"undefined"==typeof e[r]?t[r]:e[r]}function EnumProvider(e){this.getOptionValuesForRender=function(){return null},this.getOptionValuesForEdit=function(){return null};for(var t in e)this[t]=e[t]}function EditableGrid(e,t){e&&this.init(e,t)}function CellValidator(e){var t={isValid:null};for(var r in t)"undefined"!=typeof e&&"undefined"!=typeof e[r]&&(this[r]=e[r])}function NumberCellValidator(e){this.type=e}function EmailCellValidator(){}function WebsiteCellValidator(){}function DateCellValidator(e){this.grid=e}function CellRenderer(e){this.init(e)}function EnumCellRenderer(e){this.init(e)}function NumberCellRenderer(e){this.init(e)}function CheckboxCellRenderer(e){this.init(e)}function EmailCellRenderer(e){this.init(e)}function WebsiteCellRenderer(e){this.init(e)}function DateCellRenderer(e){this.init(e)}function SortHeaderRenderer(e,t){this.columnName=e,this.cellRenderer=t}function CellEditor(e){this.init(e)}function TextCellEditor(e,t,r){e&&(this.fieldSize=e),t&&(this.maxLength=t),r&&this.init(r)}function NumberCellEditor(e,t){this.type=e,this.init(t)}function SelectCellEditor(e){this.minWidth=75,this.minHeight=22,this.adaptHeight=!0,this.adaptWidth=!0,this.init(e)}function DateCellEditor(e){this.init(e)}function LeapYear(e){if(e%100==0){if(e%400==0)return!0}else if(e%4==0)return!0;return!1}function get_html_translation_table(e,t){var r={},i={},n=0,o="",l={},a={},d={},s={};if(l[0]="HTML_SPECIALCHARS",l[1]="HTML_ENTITIES",a[0]="ENT_NOQUOTES",a[2]="ENT_COMPAT",a[3]="ENT_QUOTES",d=isNaN(e)?e?e.toUpperCase():"HTML_SPECIALCHARS":l[e],s=isNaN(t)?t?t.toUpperCase():"ENT_COMPAT":a[t],"HTML_SPECIALCHARS"!==d&&"HTML_ENTITIES"!==d)throw new Error("Table: "+d+" not supported");"HTML_ENTITIES"===d&&(r[160]="&nbsp;",r[161]="&iexcl;",r[162]="&cent;",r[163]="&pound;",r[164]="&curren;",r[165]="&yen;",r[166]="&brvbar;",r[167]="&sect;",r[168]="&uml;",r[169]="&copy;",r[170]="&ordf;",r[171]="&laquo;",r[172]="&not;",r[173]="&shy;",r[174]="&reg;",r[175]="&macr;",r[176]="&deg;",r[177]="&plusmn;",r[178]="&sup2;",r[179]="&sup3;",r[180]="&acute;",r[181]="&micro;",r[182]="&para;",r[183]="&middot;",r[184]="&cedil;",r[185]="&sup1;",r[186]="&ordm;",r[187]="&raquo;",r[188]="&frac14;",r[189]="&frac12;",r[190]="&frac34;",r[191]="&iquest;",r[192]="&Agrave;",r[193]="&Aacute;",r[194]="&Acirc;",r[195]="&Atilde;",r[196]="&Auml;",r[197]="&Aring;",r[198]="&AElig;",r[199]="&Ccedil;",r[200]="&Egrave;",r[201]="&Eacute;",r[202]="&Ecirc;",r[203]="&Euml;",r[204]="&Igrave;",r[205]="&Iacute;",r[206]="&Icirc;",r[207]="&Iuml;",r[208]="&ETH;",r[209]="&Ntilde;",r[210]="&Ograve;",r[211]="&Oacute;",r[212]="&Ocirc;",r[213]="&Otilde;",r[214]="&Ouml;",r[215]="&times;",r[216]="&Oslash;",r[217]="&Ugrave;",r[218]="&Uacute;",r[219]="&Ucirc;",r[220]="&Uuml;",r[221]="&Yacute;",r[222]="&THORN;",r[223]="&szlig;",r[224]="&agrave;",r[225]="&aacute;",r[226]="&acirc;",r[227]="&atilde;",r[228]="&auml;",r[229]="&aring;",r[230]="&aelig;",r[231]="&ccedil;",r[232]="&egrave;",r[233]="&eacute;",r[234]="&ecirc;",r[235]="&euml;",r[236]="&igrave;",r[237]="&iacute;",r[238]="&icirc;",r[239]="&iuml;",r[240]="&eth;",r[241]="&ntilde;",r[242]="&ograve;",r[243]="&oacute;",r[244]="&ocirc;",r[245]="&otilde;",r[246]="&ouml;",r[247]="&divide;",r[248]="&oslash;",r[249]="&ugrave;",r[250]="&uacute;",r[251]="&ucirc;",r[252]="&uuml;",r[253]="&yacute;",r[254]="&thorn;",r[255]="&yuml;"),"ENT_NOQUOTES"!==s&&(r[34]="&quot;"),"ENT_QUOTES"===s&&(r[39]="&#39;"),r[60]="&lt;",r[62]="&gt;";for(n in r)o=String.fromCharCode(n),i[o]=r[n];return i}function htmlentities(e,t){var r={},i="",n="";if(n=e.toString(),!1===(r=this.get_html_translation_table("HTML_ENTITIES",t)))return!1;n=n.split("&").join("&amp;"),r["'"]="&#039;";for(i in r)n=n.split(i).join(r[i]);return n}function htmlspecialchars(e,t){var r={},i="",n="";if(n=e.toString(),!1===(r=this.get_html_translation_table("HTML_SPECIALCHARS",t)))return!1;n=n.split("&").join("&amp;");for(i in r)n=n.split(i).join(r[i]);return n}function number_format(e,t,r,i){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var n=isFinite(+e)?+e:0,o=isFinite(+t)?t:0,l="undefined"==typeof i?",":i,a="undefined"==typeof r?".":r,d="",s=function(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r};return d=(0>o?""+n:o?s(n,o):""+Math.round(n)).split("."),d[0].length>3&&(d[0]=d[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,l)),(d[1]||"").length<o&&(d[1]=d[1]||"",d[1]+=new Array(o-d[1].length+1).join("0")),d.join(a)}Column.prototype.getOptionValuesForRender=function(e){if(!this.enumProvider)return console.log("getOptionValuesForRender called on column "+this.name+" but there is no EnumProvider"),null;var t=this.enumProvider.getOptionValuesForRender(this.editablegrid,this,e);return t?t:this.optionValuesForRender},Column.prototype.getOptionValuesForEdit=function(e){if(!this.enumProvider)return console.log("getOptionValuesForEdit called on column "+this.name+" but there is no EnumProvider"),null;var t=this.enumProvider.getOptionValuesForEdit(this.editablegrid,this,e);return t?this.editablegrid._convertOptions(t):this.optionValues},Column.prototype.isValid=function(e){for(var t=0;t<this.cellValidators.length;t++)if(!this.cellValidators[t].isValid(e))return!1;return!0},Column.prototype.isNumerical=function(){return"double"==this.datatype||"integer"==this.datatype},EditableGrid.prototype.enableSort=!0,EditableGrid.prototype.enableStore=!0,EditableGrid.prototype.doubleclick=!1,EditableGrid.prototype.editmode="absolute",EditableGrid.prototype.editorzoneid="",EditableGrid.prototype.allowSimultaneousEdition=!1,EditableGrid.prototype.saveOnBlur=!0,EditableGrid.prototype.invalidClassName="invalid",EditableGrid.prototype.ignoreLastRow=!1,EditableGrid.prototype.caption=null,EditableGrid.prototype.dateFormat="EU",EditableGrid.prototype.shortMonthNames=null,EditableGrid.prototype.smartColorsBar=["#dc243c","#4040f6","#00f629","#efe100","#f93fb1","#6f8183","#111111"],EditableGrid.prototype.smartColorsPie=["#FF0000","#00FF00","#0000FF","#FFD700","#FF00FF","#00FFFF","#800080"],EditableGrid.prototype.pageSize=0,EditableGrid.prototype.serverSide=!1,EditableGrid.prototype.pageCount=0,EditableGrid.prototype.totalRowCount=0,EditableGrid.prototype.unfilteredRowCount=0,EditableGrid.prototype.paginatorAttributes=null,EditableGrid.prototype.lastURL=null,EditableGrid.prototype.init=function(e,t){if(("string"!=typeof e||"object"!=typeof t&&"undefined"!=typeof t)&&alert("The EditableGrid constructor takes two arguments:\n- name (string)\n- config (object)\n\nGot instead "+typeof e+" and "+typeof t+"."),"undefined"!=typeof t)for(var r in t)this[r]=t[r];if(this.Browser={IE:!(!window.attachEvent||-1!==navigator.userAgent.indexOf("Opera")),Opera:navigator.userAgent.indexOf("Opera")>-1,WebKit:navigator.userAgent.indexOf("AppleWebKit/")>-1,Gecko:navigator.userAgent.indexOf("Gecko")>-1&&-1===navigator.userAgent.indexOf("KHTML"),MobileSafari:!!navigator.userAgent.match(/Apple.*Mobile.*Safari/)},"function"!=typeof this.detectDir){var i=new Error;alert("Who is calling me now ? "+i.stack)}this.name=e,this.columns=[],this.data=[],this.dataUnfiltered=null,this.xmlDoc=null,this.sortedColumnName=-1,this.sortDescending=!1,this.baseUrl=this.detectDir(),this.nbHeaderRows=1,this.lastSelectedRowIndex=-1,this.currentPageIndex=0,this.currentFilter=null,this.currentContainerid=null,this.currentClassName=null,this.currentTableid=null,this.enableSort&&(this.sortUpImage=new Image,this.sortUpImage.src="undefined"!=typeof t&&"undefined"!=typeof t.sortIconUp?t.sortIconUp:this.baseUrl+"/images/bullet_arrow_up.png",this.sortDownImage=new Image,this.sortDownImage.src="undefined"!=typeof t&&"undefined"!=typeof t.sortIconDown?t.sortIconDown:this.baseUrl+"/images/bullet_arrow_down.png"),this.currentPageIndex=this.localisset("pageIndex")?parseInt(this.localget("pageIndex")):0,this.sortedColumnName=this.localisset("sortColumnIndexOrName")?this.localget("sortColumnIndexOrName"):-1,this.sortDescending=this.localisset("sortColumnIndexOrName")&&this.localisset("sortDescending")?"true"==this.localget("sortDescending"):!1,this.currentFilter=this.localisset("filter")?this.localget("filter"):null},EditableGrid.prototype.tableLoaded=function(){},EditableGrid.prototype.chartRendered=function(){},EditableGrid.prototype.tableRendered=function(){},EditableGrid.prototype.tableSorted=function(){},EditableGrid.prototype.tableFiltered=function(){},EditableGrid.prototype.modelChanged=function(){},EditableGrid.prototype.rowSelected=function(){},EditableGrid.prototype.isHeaderEditable=function(){return!1},EditableGrid.prototype.isEditable=function(){return!0},EditableGrid.prototype.readonlyWarning=function(){},EditableGrid.prototype.rowRemoved=function(){},EditableGrid.prototype.loadXML=function(e,t,r){this.lastURL=e;var i=this;if(window.ActiveXObject)this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.onreadystatechange=function(){4==i.xmlDoc.readyState&&(i.processXML(),i._callback("xml",t))},this.xmlDoc.load(this._addUrlParameters(e,r));else if(window.XMLHttpRequest)this.xmlDoc=new XMLHttpRequest,this.xmlDoc.onreadystatechange=function(){if(4==this.readyState){if(i.xmlDoc=this.responseXML,!i.xmlDoc)return console.error("Could not load XML from url '"+e+"'"),!1;i.processXML(),i._callback("xml",t)}},this.xmlDoc.open("GET",this._addUrlParameters(e,r),!0),this.xmlDoc.send("");else{if(!document.implementation||!document.implementation.createDocument)return alert("Cannot load a XML url with this browser!"),!1;this.xmlDoc=document.implementation.createDocument("","",null),this.xmlDoc.onload=function(){i.processXML(),i._callback("xml",t)},this.xmlDoc.load(this._addUrlParameters(e,r))}return!0},EditableGrid.prototype.loadXMLFromString=function(e){if(window.DOMParser){var t=new DOMParser;this.xmlDoc=t.parseFromString(e,"application/xml")}else this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async="false",this.xmlDoc.loadXML(e);this.processXML()},EditableGrid.prototype.processXML=function(){with(this){this.data=[],this.dataUnfiltered=null,this.table=null;var metadata=xmlDoc.getElementsByTagName("metadata");if(metadata&&metadata.length>=1){this.columns=[];for(var columnDeclarations=metadata[0].getElementsByTagName("column"),i=0;i<columnDeclarations.length;i++){var col=columnDeclarations[i],optionValuesForRender=(col.getAttribute("datatype"),null),optionValues=null,enumValues=col.getElementsByTagName("values");if(enumValues.length>0){optionValues=[],optionValuesForRender={};var enumGroups=enumValues[0].getElementsByTagName("group");if(enumGroups.length>0)for(var g=0;g<enumGroups.length;g++){var groupOptionValues=[];enumValues=enumGroups[g].getElementsByTagName("value");for(var v=0;v<enumValues.length;v++){var _value=enumValues[v].getAttribute("value"),_label=enumValues[v].firstChild?enumValues[v].firstChild.nodeValue:"";optionValuesForRender[_value]=_label,groupOptionValues.push({value:_value,label:_label})}optionValues.push({label:enumGroups[g].getAttribute("label"),values:groupOptionValues})}else{enumValues=enumValues[0].getElementsByTagName("value");for(var v=0;v<enumValues.length;v++){var _value=enumValues[v].getAttribute("value"),_label=enumValues[v].firstChild?enumValues[v].firstChild.nodeValue:"";optionValuesForRender[_value]=_label,optionValues.push({value:_value,label:_label})}}}columns.push(new Column({name:col.getAttribute("name"),label:col.getAttribute("string"==typeof col.getAttribute("label")?"label":"name"),datatype:col.getAttribute("datatype")?col.getAttribute("datatype"):"string",editable:"true"==col.getAttribute("editable"),bar:col.getAttribute("bar")?"true"==col.getAttribute("bar"):!0,hidden:col.getAttribute("hidden")?"true"==col.getAttribute("hidden"):!1,optionValuesForRender:optionValuesForRender,optionValues:optionValues}))}processColumns()}var paginator=xmlDoc.getElementsByTagName("paginator");paginator&&paginator.length>=1&&(this.paginatorAttributes=null,this.pageCount=paginator[0].getAttribute("pagecount"),this.totalRowCount=paginator[0].getAttribute("totalrowcount"),this.unfilteredRowCount=paginator[0].getAttribute("unfilteredrowcount"));for(var defaultRowId=1,rows=xmlDoc.getElementsByTagName("row"),i=0;i<rows.length;i++){for(var cellValues={},cols=rows[i].getElementsByTagName("column"),j=0;j<cols.length;j++){var colname=cols[j].getAttribute("name");colname||(j>=columns.length?console.error("You defined too many columns for row "+(i+1)):colname=columns[j].name),cellValues[colname]=cols[j].firstChild?cols[j].firstChild.nodeValue:""}for(var rowData={visible:!0,originalIndex:i,id:rows[i].getAttribute("id")?rows[i].getAttribute("id"):defaultRowId++},attrIndex=0;attrIndex<rows[i].attributes.length;attrIndex++){var node=rows[i].attributes.item(attrIndex);"id"!=node.nodeName&&(rowData[node.nodeName]=node.nodeValue)}rowData.columns=[];for(var c=0;c<columns.length;c++){var cellValue=columns[c].name in cellValues?cellValues[columns[c].name]:"";rowData.columns.push(getTypedValue(c,cellValue))}data.push(rowData)}}return!0},EditableGrid.prototype.loadJSON=function(e,t,r){this.lastURL=e;var i=this;if(!window.XMLHttpRequest)return alert("Cannot load a JSON url with this browser!"),!1;var n=new XMLHttpRequest;return n.onreadystatechange=function(){if(4==this.readyState){if(!this.responseText)return console.error("Could not load JSON from url '"+e+"'"),!1;if(!i.processJSON(this.responseText))return console.error("Invalid JSON data obtained from url '"+e+"'"),!1;i._callback("json",t)}},n.open("GET",this._addUrlParameters(e,r),!0),n.send(""),!0},EditableGrid.prototype._addUrlParameters=function(e,t){var r=e.indexOf("?")>=0?"&":"?";return e+=r+(new Date).getTime(),this.serverSide?e+"&page="+(this.currentPageIndex+1)+"&filter="+(this.currentFilter?encodeURIComponent(this.currentFilter):"")+"&sort="+(this.sortedColumnName&&-1!=this.sortedColumnName?encodeURIComponent(this.sortedColumnName):"")+"&asc="+(this.sortDescending?0:1)+(t?"&data_only=1":""):e},EditableGrid.prototype._callback=function(e,t){t?t.call(this):(this.serverSide&&(this.refreshGrid=function(t){var r=function(){EditableGrid.prototype.refreshGrid.call(this)},i="xml"==e?this.loadXML:this.loadJSON;i.call(this,t||this.lastURL,r,!0)}),this.tableLoaded())},EditableGrid.prototype.loadJSONFromString=function(e){return this.processJSON(e)},EditableGrid.prototype.load=function(e){return this.processJSON(e)},EditableGrid.prototype.update=function(e){if(e.data)for(var t=0;t<e.data.length;t++){var r=e.data[t];if(r.id&&r.values){var i=this.getRowIndex(r.id),n=this.data[i];if("[object Array]"!==Object.prototype.toString.call(r.values))cellValues=r.values;else{cellValues={};for(var o=0;o<r.values.length&&o<this.columns.length;o++)cellValues[this.columns[o].name]=r.values[o]}for(var l in r)"id"!=l&&"values"!=l&&(n[l]=r[l]);n.columns=[];for(var a=0;a<this.columns.length;a++){var d=this.columns[a].name in cellValues?cellValues[this.columns[a].name]:"";n.columns.push(this.getTypedValue(a,d))}for(var s=this.getRow(i),o=0;o<s.cells.length&&o<this.columns.length;o++)this.columns[o].renderable&&this.columns[o].cellRenderer._render(i,o,s.cells[o],this.getValueAt(i,o));this.tableRendered(this.currentContainerid,this.currentClassName,this.currentTableid)}}},EditableGrid.prototype.processJSON=function(jsonData){if("string"==typeof jsonData&&(jsonData=eval("("+jsonData+")")),!jsonData)return!1;if(this.data=[],this.dataUnfiltered=null,this.table=null,jsonData.metadata){this.columns=[];for(var c=0;c<jsonData.metadata.length;c++){var columndata=jsonData.metadata[c],optionValues=columndata.values?this._convertOptions(columndata.values):null,optionValuesForRender=null;if(optionValues)for(var optionValuesForRender={},optionIndex=0;optionIndex<optionValues.length;optionIndex++){var optionValue=optionValues[optionIndex];if("object"==typeof optionValue.values)for(var groupOptionIndex=0;groupOptionIndex<optionValue.values.length;groupOptionIndex++){var groupOptionValue=optionValue.values[groupOptionIndex];optionValuesForRender[groupOptionValue.value]=groupOptionValue.label}else optionValuesForRender[optionValue.value]=optionValue.label}this.columns.push(new Column({name:columndata.name,label:columndata.label?columndata.label:columndata.name,datatype:columndata.datatype?columndata.datatype:"string",editable:columndata.editable?!0:!1,bar:"undefined"==typeof columndata.bar?!0:columndata.bar||!1,hidden:"undefined"==typeof columndata.hidden?!1:columndata.hidden?!0:!1,optionValuesForRender:optionValuesForRender,optionValues:optionValues}))}this.processColumns()}jsonData.paginator&&(this.paginatorAttributes=jsonData.paginator,this.pageCount=jsonData.paginator.pagecount,this.totalRowCount=jsonData.paginator.totalrowcount,this.unfilteredRowCount=jsonData.paginator.unfilteredrowcount);var defaultRowId=1;if(jsonData.data)for(var i=0;i<jsonData.data.length;i++){var row=jsonData.data[i];if(row.values){if("[object Array]"!==Object.prototype.toString.call(row.values))cellValues=row.values;else{cellValues={};for(var j=0;j<row.values.length&&j<this.columns.length;j++)cellValues[this.columns[j].name]=row.values[j]}var rowData={visible:!0,originalIndex:i,id:row.id?row.id:defaultRowId++};for(var attributeName in row)"id"!=attributeName&&"values"!=attributeName&&(rowData[attributeName]=row[attributeName]);rowData.columns=[];for(var c=0;c<this.columns.length;c++){var cellValue=this.columns[c].name in cellValues?cellValues[this.columns[c].name]:"";rowData.columns.push(this.getTypedValue(c,cellValue))}this.data.push(rowData)}}return!0},EditableGrid.prototype.processColumns=function(){for(var e=0;e<this.columns.length;e++){var t=this.columns[e];t.columnIndex=e,t.editablegrid=this,this.parseColumnType(t),t.enumProvider||(t.enumProvider=t.optionValues?new EnumProvider:null),t.cellRenderer||this._createCellRenderer(t),t.headerRenderer||this._createHeaderRenderer(t),t.cellEditor||this._createCellEditor(t),t.headerEditor||this._createHeaderEditor(t),this._addDefaultCellValidators(t)}},EditableGrid.prototype.parseColumnType=function(e){if(e.unit=null,e.precision=-1,e.decimal_point=",",e.thousands_separator=".",e.unit_before_number=!1,e.nansymbol="",e.datatype.match(/(.*)\((.*),(.*),(.*),(.*),(.*),(.*)\)$/))e.datatype=RegExp.$1,e.unit=RegExp.$2,e.precision=parseInt(RegExp.$3),e.decimal_point=RegExp.$4,e.thousands_separator=RegExp.$5,e.unit_before_number=RegExp.$6,e.nansymbol=RegExp.$7,e.unit=e.unit.trim(),e.decimal_point=e.decimal_point.trim(),e.thousands_separator=e.thousands_separator.trim(),e.unit_before_number="1"==e.unit_before_number.trim(),e.nansymbol=e.nansymbol.trim();else if(e.datatype.match(/(.*)\((.*),(.*),(.*),(.*),(.*)\)$/))e.datatype=RegExp.$1,e.unit=RegExp.$2,e.precision=parseInt(RegExp.$3),e.decimal_point=RegExp.$4,e.thousands_separator=RegExp.$5,e.unit_before_number=RegExp.$6,e.unit=e.unit.trim(),e.decimal_point=e.decimal_point.trim(),e.thousands_separator=e.thousands_separator.trim(),e.unit_before_number="1"==e.unit_before_number.trim();else if(e.datatype.match(/(.*)\((.*),(.*),(.*)\)$/))e.datatype=RegExp.$1,e.unit=RegExp.$2.trim(),e.precision=parseInt(RegExp.$3),e.nansymbol=RegExp.$4.trim();else if(e.datatype.match(/(.*)\((.*),(.*)\)$/))e.datatype=RegExp.$1.trim(),e.unit=RegExp.$2.trim(),e.precision=parseInt(RegExp.$3);else if(e.datatype.match(/(.*)\((.*)\)$/)){e.datatype=RegExp.$1.trim();var t=RegExp.$2.trim();t.match(/^[0-9]*$/)?e.precision=parseInt(t):e.unit=t}"comma"==e.decimal_point&&(e.decimal_point=","),"dot"==e.decimal_point&&(e.decimal_point="."),"comma"==e.thousands_separator&&(e.thousands_separator=","),"dot"==e.thousands_separator&&(e.thousands_separator="."),isNaN(e.precision)&&(e.precision=-1),""==e.unit&&(e.unit=null),""==e.nansymbol&&(e.nansymbol=null)},EditableGrid.prototype.getTypedValue=function(e,t){if(null===t)return t;var r=this.getColumnType(e);return"boolean"==r&&(t=t&&0!=t&&"false"!=t?!0:!1),"integer"==r&&(t=parseInt(t,10)),"double"==r&&(t=parseFloat(t)),"string"==r&&(t=""+t),t},EditableGrid.prototype.attachToHTMLTable=function(e,t){if(this.data=[],this.dataUnfiltered=null,this.table=null,t){this.columns=t;for(var r=0;r<this.columns.length;r++)this.columns[r].optionValues=this._convertOptions(this.columns[r].optionValues);this.processColumns()}this.table="string"==typeof e?_$(e):e,this.table||console.error("Invalid table given: "+e),this.tHead=this.table.tHead,this.tBody=this.table.tBodies[0],this.tBody||(this.tBody=document.createElement("TBODY"),this.table.insertBefore(this.tBody,this.table.firstChild)),this.tHead||(this.tHead=document.createElement("THEAD"),this.table.insertBefore(this.tHead,this.tBody)),0==this.tHead.rows.length&&this.tBody.rows.length>0&&this.tHead.appendChild(this.tBody.rows[0]),this.nbHeaderRows=this.tHead.rows.length;for(var i=this.tHead.rows,n=0;n<i.length;n++)for(var o=i[n].cells,l=0,a=0;a<o.length&&l<this.columns.length;a++){this.columns[l].label&&this.columns[l].label!=this.columns[l].name||(this.columns[l].label=o[a].innerHTML);var d=parseInt(o[a].getAttribute("colspan"));l+=d>1?d:1}for(var i=this.tBody.rows,n=0;n<i.length;n++){for(var s=[],o=i[n].cells,a=0;a<o.length&&a<this.columns.length;a++)s.push(this.getTypedValue(a,o[a].innerHTML));this.data.push({visible:!0,originalIndex:n,id:i[n].id,columns:s}),i[n].rowId=i[n].id,i[n].id=this._getRowDOMId(i[n].id)}},EditableGrid.prototype._createCellRenderer=function(e){e.cellRenderer=e.enumProvider&&"list"==e.datatype&&"undefined"!=typeof MultiselectCellRenderer?new MultiselectCellRenderer:e.enumProvider?new EnumCellRenderer:"integer"==e.datatype||"double"==e.datatype?new NumberCellRenderer:"boolean"==e.datatype?new CheckboxCellRenderer:"email"==e.datatype?new EmailCellRenderer:"website"==e.datatype||"url"==e.datatype?new WebsiteCellRenderer:"date"==e.datatype?new DateCellRenderer:new CellRenderer,e.cellRenderer&&(e.cellRenderer.editablegrid=this,e.cellRenderer.column=e)},EditableGrid.prototype._createHeaderRenderer=function(e){e.headerRenderer=this.enableSort&&"html"!=e.datatype?new SortHeaderRenderer(e.name):new CellRenderer,e.headerRenderer&&(e.headerRenderer.editablegrid=this,e.headerRenderer.column=e)},EditableGrid.prototype._createCellEditor=function(e){e.cellEditor=e.enumProvider&&"list"==e.datatype&&"undefined"!=typeof MultiselectCellEditor?new MultiselectCellEditor:e.enumProvider?new SelectCellEditor:"integer"==e.datatype||"double"==e.datatype?new NumberCellEditor(e.datatype):"boolean"==e.datatype?null:"email"==e.datatype?new TextCellEditor(e.precision):"website"==e.datatype||"url"==e.datatype?new TextCellEditor(e.precision):"date"==e.datatype?"undefined"==typeof jQuery||"undefined"==typeof jQuery.datepicker?new TextCellEditor(e.precision,10):new DateCellEditor({fieldSize:e.precision,maxLength:10}):new TextCellEditor(e.precision),e.cellEditor&&(e.cellEditor.editablegrid=this,e.cellEditor.column=e)},EditableGrid.prototype._createHeaderEditor=function(e){e.headerEditor=new TextCellEditor,e.headerEditor&&(e.headerEditor.editablegrid=this,e.headerEditor.column=e)},EditableGrid.prototype.getRowCount=function(){return this.data.length},EditableGrid.prototype.getUnfilteredRowCount=function(){if(this.unfilteredRowCount>0)return this.unfilteredRowCount;var e=null==this.dataUnfiltered?this.data:this.dataUnfiltered;return e.length},EditableGrid.prototype.getTotalRowCount=function(){return this.totalRowCount>0?this.totalRowCount:this.getRowCount()},EditableGrid.prototype.getColumnCount=function(){return this.columns.length},EditableGrid.prototype.hasColumn=function(e){return this.getColumnIndex(e)>=0},EditableGrid.prototype.getColumn=function(e){var t=this.getColumnIndex(e);return 0>t?(console.error("[getColumn] Column not found with index or name "+e),null):this.columns[t]},EditableGrid.prototype.getColumnName=function(e){return this.getColumn(e).name},EditableGrid.prototype.getColumnLabel=function(e){return this.getColumn(e).label},EditableGrid.prototype.getColumnType=function(e){return this.getColumn(e).datatype},EditableGrid.prototype.getColumnUnit=function(e){return this.getColumn(e).unit},EditableGrid.prototype.getColumnPrecision=function(e){return this.getColumn(e).precision},EditableGrid.prototype.isColumnBar=function(e){var t=this.getColumn(e);return t.bar&&t.isNumerical()},EditableGrid.prototype.getColumnStack=function(e){var t=this.getColumn(e);return t.isNumerical()?t.bar:""},EditableGrid.prototype.isColumnNumerical=function(e){var t=this.getColumn(e);return t.isNumerical()},EditableGrid.prototype.getValueAt=function(e,t){if(0>t||t>=this.columns.length)return console.error("[getValueAt] Invalid column index "+t),null;var r=this.columns[t];if(0>e)return r.label;if("undefined"==typeof this.data[e])return console.error("[getValueAt] Invalid row index "+e),null;var i=this.data[e].columns;return i?i[t]:null},EditableGrid.prototype.getDisplayValueAt=function(e,t){var r=this.getValueAt(e,t),i=0>e?this.columns[t].headerRenderer:this.columns[t].cellRenderer;return i.getDisplayValue(e,r)},EditableGrid.prototype.setValueAt=function(e,t,r,i){"undefined"==typeof i&&(i=!0);var n=null;if(0>t||t>=this.columns.length)return console.error("[setValueAt] Invalid column index "+t),null;var o=this.columns[t];if(0>e)n=o.label,o.label=r;else{if("undefined"==typeof this.data[e])return console.error("Invalid rowindex "+e),null;var l=this.data[e].columns;n=l[t],l&&(l[t]=this.getTypedValue(t,r))}if(i){var a=0>e?o.headerRenderer:o.cellRenderer,d=this.getCell(e,t);d&&a._render(e,t,d,r)}return n},EditableGrid.prototype.getColumnIndex=function(e){if("undefined"==typeof e||""===e)return-1;if(!isNaN(e)&&e>=0&&e<this.columns.length)return e;for(var t=0;t<this.columns.length;t++)if(this.columns[t].name==e)return t;return-1},EditableGrid.prototype.getRow=function(e){return 0>e?this.tHead.rows[e+this.nbHeaderRows]:"undefined"==typeof this.data[e]?(console.error("[getRow] Invalid row index "+e),null):_$(this._getRowDOMId(this.data[e].id))},EditableGrid.prototype.getRowId=function(e){return 0>e||e>=this.data.length?null:this.data[e].id},EditableGrid.prototype.getRowIndex=function(e){e="object"==typeof e?e.rowId:e;for(var t=0;t<this.data.length;t++)if(this.data[t].id==e)return t;return-1},EditableGrid.prototype.getRowAttribute=function(e,t){return"undefined"==typeof this.data[e]?(console.error("Invalid rowindex "+e),null):this.data[e][t]},EditableGrid.prototype.setRowAttribute=function(e,t,r){this.data[e][t]=r},EditableGrid.prototype._getRowDOMId=function(e){return null!=this.currentContainerid?this.name+"_"+e:e},EditableGrid.prototype.removeRow=function(e){return this.remove(this.getRowIndex(e))},EditableGrid.prototype.remove=function(e){var t=this.data[e].id,r=this.data[e].originalIndex,i=null==this.dataUnfiltered?this.data:this.dataUnfiltered,n=_$(this._getRowDOMId(t));null!=n&&this.tBody.removeChild(n);for(var o=0;o<i.length;o++)i[o].originalIndex>=r&&i[o].originalIndex--;if(this.data.splice(e,1),null!=this.dataUnfiltered)for(var o=0;o<this.dataUnfiltered.length;o++)if(this.dataUnfiltered[o].id==t){this.dataUnfiltered.splice(o,1);break}this.rowRemoved(e,t),this.refreshGrid()},EditableGrid.prototype.getRowValues=function(e){for(var t={},r=0;r<this.getColumnCount();r++)t[this.getColumnName(r)]=this.getValueAt(e,r);return t},EditableGrid.prototype.append=function(e,t,r,i){return 0===this.data.length?this._insert(this.data.length,0,e,t,r,i):this.insertAfter(this.data.length-1,e,t,r,i)},EditableGrid.prototype.addRow=function(e,t,r,i){return this.append(e,t,r,i)},EditableGrid.prototype._insert=function(e,t,r,i,n,o){var l=null,a=0,d=null==this.dataUnfiltered?this.data:this.dataUnfiltered;if("undefined"!=typeof this.data[e]&&(l=this.data[e].id,a=this.data[e].originalIndex+t),null==this.currentContainerid){var s=this.tBody.insertRow(e+t);s.rowId=r,s.id=this._getRowDOMId(r);for(var u=0;u<this.columns.length;u++)s.insertCell(u)}var c={visible:!0,originalIndex:a,id:r};if(n)for(var p in n)c[p]=n[p];c.columns=[];for(var u=0;u<this.columns.length;u++){var h=this.columns[u].name in i?i[this.columns[u].name]:"";c.columns.push(this.getTypedValue(u,h))}for(var m=0;m<d.length;m++)d[m].originalIndex>=a&&d[m].originalIndex++;if(this.data.splice(e+t,0,c),null!=this.dataUnfiltered)if(null===l)this.dataUnfiltered.splice(e+t,0,c);else for(var m=0;m<this.dataUnfiltered.length;m++)if(this.dataUnfiltered[m].id==l){this.dataUnfiltered.splice(m+t,0,c);break}this.refreshGrid(),o||this.sort(),this.filter()},EditableGrid.prototype.insert=function(e,t,r,i,n){return 0>e&&(e=0),e>=this.data.length&&this.data.length>0?this.insertAfter(this.data.length-1,t,r,i,n):this._insert(e,0,t,r,i,n)},EditableGrid.prototype.insertAfter=function(e,t,r,i,n){return 0>e?this.insert(0,t,r,i,n):(e>=this.data.length&&(e=this.data.length-1),this._insert(e,1,t,r,i,n))},EditableGrid.prototype.setHeaderRenderer=function(e,t){var r=this.getColumnIndex(e);if(0>r)console.error("[setHeaderRenderer] Invalid column: "+e);else{var i=this.columns[r];i.headerRenderer=this.enableSort&&"html"!=i.datatype?new SortHeaderRenderer(i.name,t):t,t&&(this.enableSort&&"html"!=i.datatype&&(i.headerRenderer.editablegrid=this,i.headerRenderer.column=i),t.editablegrid=this,t.column=i)}},EditableGrid.prototype.setCellRenderer=function(e,t){var r=this.getColumnIndex(e);if(0>r)console.error("[setCellRenderer] Invalid column: "+e);else{var i=this.columns[r];i.cellRenderer=t,t&&(t.editablegrid=this,t.column=i)}},EditableGrid.prototype.setCellEditor=function(e,t){var r=this.getColumnIndex(e);if(0>r)console.error("[setCellEditor] Invalid column: "+e);else{var i=this.columns[r];i.cellEditor=t,t&&(t.editablegrid=this,t.column=i)}},EditableGrid.prototype.setHeaderEditor=function(e,t){var r=this.getColumnIndex(e);if(0>r)console.error("[setHeaderEditor] Invalid column: "+e);else{var i=this.columns[r];i.headerEditor=t,t&&(t.editablegrid=this,t.column=i)}},EditableGrid.prototype.setEnumProvider=function(e,t){var r=this.getColumnIndex(e);if(0>r)console.error("[setEnumProvider] Invalid column: "+e);else{var i=null!=this.columns[r].enumProvider;this.columns[r].enumProvider=t,i||(this._createCellRenderer(this.columns[r]),this._createCellEditor(this.columns[r]))}},EditableGrid.prototype.clearCellValidators=function(e){var t=this.getColumnIndex(e);0>t?console.error("[clearCellValidators] Invalid column: "+e):this.columns[t].cellValidators=[]},EditableGrid.prototype.addDefaultCellValidators=function(e){var t=this.getColumnIndex(e);return 0>t&&console.error("[addDefaultCellValidators] Invalid column: "+e),this._addDefaultCellValidators(this.columns[t])},EditableGrid.prototype._addDefaultCellValidators=function(e){"integer"==e.datatype||"double"==e.datatype?e.cellValidators.push(new NumberCellValidator(e.datatype)):"email"==e.datatype?e.cellValidators.push(new EmailCellValidator):"website"==e.datatype||"url"==e.datatype?e.cellValidators.push(new WebsiteCellValidator):"date"==e.datatype&&e.cellValidators.push(new DateCellValidator(this))},EditableGrid.prototype.addCellValidator=function(e,t){var r=this.getColumnIndex(e);0>r?console.error("[addCellValidator] Invalid column: "+e):this.columns[r].cellValidators.push(t)},EditableGrid.prototype.setCaption=function(e){this.caption=e},EditableGrid.prototype.getCell=function(e,t){var r=this.getRow(e);return null==r?(console.error("[getCell] Invalid row index "+e),null):r.cells[t]},EditableGrid.prototype.getCellX=function(e){for(var t=0;null!=e&&this.isStatic(e);)try{t+=e.offsetLeft,e=e.offsetParent}catch(r){e=null}return t},EditableGrid.prototype.getCellY=function(e){for(var t=0;null!=e&&this.isStatic(e);)try{t+=e.offsetTop,e=e.offsetParent}catch(r){e=null}return t},EditableGrid.prototype.getScrollXOffset=function(e){for(var t=0;null!=e&&"undefined"!=typeof e.scrollLeft&&this.isStatic(e)&&e!=document.body;)try{t+=parseInt(e.scrollLeft),e=e.parentNode
}catch(r){e=null}return t},EditableGrid.prototype.getScrollYOffset=function(e){for(var t=0;null!=e&&"undefined"!=typeof e.scrollTop&&this.isStatic(e)&&e!=document.body;)try{t+=parseInt(e.scrollTop),e=e.parentNode}catch(r){e=null}return t},EditableGrid.prototype._rendergrid=function(containerid,className,tableid){with(this){if(lastSelectedRowIndex=-1,_currentPageIndex=getCurrentPageIndex(),"undefined"!=typeof table&&null!=table){var _data=null==dataUnfiltered?data:dataUnfiltered;_renderHeaders();for(var rows=tBody.rows,skipped=0,displayed=0,rowIndex=0,i=0;i<rows.length;i++)if(!_data[i].visible||pageSize>0&&displayed>=pageSize)"none"!=rows[i].style.display&&(rows[i].style.display="none",rows[i].hidden_by_editablegrid=!0);else{if(pageSize*_currentPageIndex>skipped)skipped++,"none"!=rows[i].style.display&&(rows[i].style.display="none",rows[i].hidden_by_editablegrid=!0);else{displayed++;var cols=rows[i].cells;"undefined"!=typeof rows[i].hidden_by_editablegrid&&rows[i].hidden_by_editablegrid&&(rows[i].style.display="",rows[i].hidden_by_editablegrid=!1),rows[i].rowId=getRowId(rowIndex),rows[i].id=_getRowDOMId(rows[i].rowId);for(var j=0;j<cols.length&&j<columns.length;j++)columns[j].renderable&&columns[j].cellRenderer._render(rowIndex,j,cols[j],getValueAt(rowIndex,j))}rowIndex++}table.editablegrid=this,doubleclick?table.ondblclick=function(e){this.editablegrid.mouseClicked(e)}:table.onclick=function(e){this.editablegrid.mouseClicked(e)}}else{if(!containerid)return console.warn("The container ID not specified (renderGrid not called yet ?)");if(!_$(containerid))return console.error("Unable to get element ["+containerid+"]");currentContainerid=containerid,currentClassName=className,currentTableid=tableid;var startRowIndex=0,endRowIndex=getRowCount();for(pageSize>0&&(startRowIndex=_currentPageIndex*pageSize,endRowIndex=Math.min(getRowCount(),startRowIndex+pageSize)),this.table=document.createElement("table"),table.className=className||"editablegrid","undefined"!=typeof tableid&&(table.id=tableid);_$(containerid).hasChildNodes();)_$(containerid).removeChild(_$(containerid).firstChild);if(_$(containerid).appendChild(table),caption){var captionElement=document.createElement("CAPTION");captionElement.innerHTML=this.caption,table.appendChild(captionElement)}this.tHead=document.createElement("THEAD"),table.appendChild(tHead);for(var trHeader=tHead.insertRow(0),columnCount=getColumnCount(),c=0;columnCount>c;c++){var headerCell=document.createElement("TH"),td=trHeader.appendChild(headerCell);columns[c].headerRenderer._render(-1,c,td,columns[c].label)}this.tBody=document.createElement("TBODY"),table.appendChild(tBody);for(var insertRowIndex=0,i=startRowIndex;endRowIndex>i;i++){var tr=tBody.insertRow(insertRowIndex++);for(tr.rowId=data[i].id,tr.id=this._getRowDOMId(data[i].id),j=0;columnCount>j;j++){var td=tr.insertCell(j);columns[j].cellRenderer._render(i,j,td,getValueAt(i,j))}}_$(containerid).editablegrid=this,doubleclick?_$(containerid).ondblclick=function(e){this.editablegrid.mouseClicked(e)}:_$(containerid).onclick=function(e){this.editablegrid.mouseClicked(e)}}tableRendered(containerid,className,tableid)}},EditableGrid.prototype.renderGrid=function(e,t,r){this._rendergrid(e,t,r),this.serverSide||(this.sort(),this.filter())},EditableGrid.prototype.refreshGrid=function(){null!=this.currentContainerid&&(this.table=null),this._rendergrid(this.currentContainerid,this.currentClassName,this.currentTableid)},EditableGrid.prototype._renderHeaders=function(){with(this)for(var rows=tHead.rows,i=0;1>i;i++)for(var cols=rows[i].cells,columnIndexInModel=0,j=0;j<cols.length&&columnIndexInModel<columns.length;j++){columns[columnIndexInModel].headerRenderer._render(-1,columnIndexInModel,cols[j],columns[columnIndexInModel].label);var colspan=parseInt(cols[j].getAttribute("colspan"));columnIndexInModel+=colspan>1?colspan:1}},EditableGrid.prototype.mouseClicked=function(e){with(e=e||window.event,this){for(var target=e.target||e.srcElement;target&&"A"!=target.tagName&&"TD"!=target.tagName&&"TH"!=target.tagName;)target=target.parentNode;if(!target||!target.parentNode||!target.parentNode.parentNode||"TBODY"!=target.parentNode.parentNode.tagName&&"THEAD"!=target.parentNode.parentNode.tagName||target.isEditing)return;if("A"==target.tagName)return;var rowIndex=getRowIndex(target.parentNode),columnIndex=target.cellIndex;editCell(rowIndex,columnIndex)}},EditableGrid.prototype.editCell=function(rowIndex,columnIndex){var target=this.getCell(rowIndex,columnIndex);with(this){var column=columns[columnIndex];column&&(rowIndex>-1&&rowIndex!=lastSelectedRowIndex&&(rowSelected(lastSelectedRowIndex,rowIndex),lastSelectedRowIndex=rowIndex),column.editable?0>rowIndex?column.headerEditor&&isHeaderEditable(rowIndex,columnIndex)&&column.headerEditor.edit(rowIndex,columnIndex,target,column.label):column.cellEditor&&isEditable(rowIndex,columnIndex)&&column.cellEditor.edit(rowIndex,columnIndex,target,getValueAt(rowIndex,columnIndex)):readonlyWarning(column))}},EditableGrid.prototype.sortColumns=function(headerArray){with(this){newColumns=[],newColumnIndices=[];for(var i=0;i<headerArray.length;i++){if(columnIndex=this.getColumnIndex(headerArray[i]),-1==columnIndex)return console.error("[sortColumns] Invalid column: "+columnIndex),!1;newColumns[i]=this.columns[columnIndex],newColumnIndices[i]=columnIndex}this.columns=newColumns;for(var i=0;i<this.data.length;i++){for(var myData=this.data[i],myDataColumns=myData.columns,newDataColumns=[],j=0;j<myDataColumns.length;j++)newIndex=newColumnIndices[j],newDataColumns[j]=myDataColumns[newIndex];this.data[i].columns=newDataColumns}return!0}},EditableGrid.prototype.sort=function(columnIndexOrName,descending,backOnFirstPage){with(this){if("undefined"==typeof columnIndexOrName&&-1===sortedColumnName)return tableSorted(-1,sortDescending),!0;if("undefined"==typeof columnIndexOrName&&(columnIndexOrName=sortedColumnName),"undefined"==typeof descending&&(descending=sortDescending),localset("sortColumnIndexOrName",columnIndexOrName),localset("sortDescending",descending),serverSide)return backOnFirstPage?setPageIndex(0):refreshGrid();var columnIndex=columnIndexOrName;if(-1!==parseInt(columnIndex,10)&&(columnIndex=this.getColumnIndex(columnIndexOrName),0>columnIndex))return console.error("[sort] Invalid column: "+columnIndexOrName),!1;if(!enableSort)return void tableSorted(columnIndex,descending);var filterActive=null!=dataUnfiltered;filterActive&&(data=dataUnfiltered);for(var type=0>columnIndex?"":getColumnType(columnIndex),row_array=[],rowCount=getRowCount(),i=0;rowCount-(ignoreLastRow?1:0)>i;i++)row_array.push([0>columnIndex?null:getDisplayValueAt(i,columnIndex),i,data[i].originalIndex]);var sort_function="integer"==type||"double"==type?sort_numeric:"boolean"==type?sort_boolean:"date"==type?sort_date:sort_alpha;row_array.sort(0>columnIndex?unsort:sort_stable(sort_function,descending)),ignoreLastRow&&row_array.push([0>columnIndex?null:getDisplayValueAt(rowCount-1,columnIndex),rowCount-1,data[rowCount-1].originalIndex]);var _data=data;data=[];for(var i=0;i<row_array.length;i++)data.push(_data[row_array[i][1]]);if(delete row_array,filterActive){dataUnfiltered=data,data=[];for(var r=0;rowCount>r;r++)dataUnfiltered[r].visible&&data.push(dataUnfiltered[r])}return backOnFirstPage?setPageIndex(0):refreshGrid(),tableSorted(columnIndex,descending),!0}},EditableGrid.prototype.filter=function(filterString,cols){with(this){if("undefined"!=typeof filterString&&(this.currentFilter=filterString,this.localset("filter",filterString)),serverSide)return setPageIndex(0);if(null==currentFilter||""==currentFilter){if(null!=dataUnfiltered){data=dataUnfiltered,dataUnfiltered=null;for(var r=0;r<getRowCount();r++)data[r].visible=!0;setPageIndex(0),tableFiltered()}return}var words=currentFilter.toLowerCase().split(" ");null!=dataUnfiltered&&(data=dataUnfiltered);for(var rowCount=getRowCount(),columnCount="undefined"!=typeof cols?cols.length:getColumnCount(),r=0;rowCount>r;r++){var row=data[r];row.visible=!0;for(var rowContent="",c=0;columnCount>c;c++)if("boolean"!=getColumnType(c)){var displayValue=getDisplayValueAt(r,"undefined"!=typeof cols?cols[c]:c),value=getValueAt(r,"undefined"!=typeof cols?cols[c]:c);rowContent+=displayValue+" "+(displayValue==value?"":value+" ")}for(var attributeName in row)"visible"!=attributeName&&"originalIndex"!=attributeName&&"columns"!=attributeName&&(rowContent+=row[attributeName]);for(var i=0;i<words.length;i++){var word=words[i],match=!1,invertMatch=word.startsWith("!");invertMatch&&(word=word.substr(1));var colindex=-1,attributeName=null;if(word.contains("!=")){var parts=word.split("!=");colindex=getColumnIndex(parts[0]),colindex>=0?(word=parts[1],invertMatch=!invertMatch):"undefined"!=typeof row[parts[0]]&&(attributeName=parts[0],word=parts[1],invertMatch=!invertMatch)}else if(word.contains("=")){var parts=word.split("=");colindex=getColumnIndex(parts[0]),colindex>=0?word=parts[1]:"undefined"!=typeof row[parts[0]]&&(attributeName=parts[0],word=parts[1])}if(word.endsWith("!"))if(word=word.substr(0,word.length-1),colindex>=0)match=(""+getDisplayValueAt(r,colindex)).trim().toLowerCase()==word||(""+getValueAt(r,colindex)).trim().toLowerCase()==word;else if(null!==attributeName)match=(""+getRowAttribute(r,attributeName)).trim().toLowerCase()==word;else for(var c=0;columnCount>c;c++)"boolean"!=getColumnType("undefined"!=typeof cols?cols[c]:c)&&((""+getDisplayValueAt(r,"undefined"!=typeof cols?cols[c]:c)).trim().toLowerCase()==word||(""+getValueAt(r,"undefined"!=typeof cols?cols[c]:c)).trim().toLowerCase()==word)&&(match=!0);else match=colindex>=0?(getValueAt(r,colindex)+" "+getDisplayValueAt(r,colindex)).trim().toLowerCase().indexOf(word)>=0:null!==attributeName?(""+getRowAttribute(r,attributeName)).trim().toLowerCase().indexOf(word)>=0:rowContent.toLowerCase().indexOf(word)>=0;if(invertMatch?match:!match){data[r].visible=!1;break}}}dataUnfiltered=data,data=[];for(var r=0;rowCount>r;r++)dataUnfiltered[r].visible&&data.push(dataUnfiltered[r]);setPageIndex(0),tableFiltered()}},EditableGrid.prototype.setPageSize=function(e){this.pageSize=parseInt(e),isNaN(this.pageSize)&&(this.pageSize=0),this.currentPageIndex=0,this.refreshGrid()},EditableGrid.prototype.getPageCount=function(){return 0==this.getRowCount()?0:this.pageCount>0?this.pageCount:this.pageSize<=0?(console.error("getPageCount: no or invalid page size defined ("+this.pageSize+")"),-1):Math.ceil(this.getRowCount()/this.pageSize)},EditableGrid.prototype.getCurrentPageIndex=function(){return this.pageSize<=0&&!this.serverSide?0:Math.max(0,this.currentPageIndex>=this.getPageCount()?this.getPageCount()-1:this.currentPageIndex)},EditableGrid.prototype.setPageIndex=function(e){this.currentPageIndex=e,this.localset("pageIndex",e),this.refreshGrid()},EditableGrid.prototype.prevPage=function(){this.canGoBack()&&this.setPageIndex(this.getCurrentPageIndex()-1)},EditableGrid.prototype.firstPage=function(){this.canGoBack()&&this.setPageIndex(0)},EditableGrid.prototype.nextPage=function(){this.canGoForward()&&this.setPageIndex(this.getCurrentPageIndex()+1)},EditableGrid.prototype.lastPage=function(){this.canGoForward()&&this.setPageIndex(this.getPageCount()-1)},EditableGrid.prototype.canGoBack=function(){return this.getCurrentPageIndex()>0},EditableGrid.prototype.canGoForward=function(){return this.getCurrentPageIndex()<this.getPageCount()-1},EditableGrid.prototype.getSlidingPageInterval=function(e){var t=this.getPageCount();if(1>=t)return null;var r=this.getCurrentPageIndex(),i=Math.max(0,r-Math.floor(e/2)),n=Math.min(t-1,r+Math.floor(e/2));if(e>n-i){var o=e-(n-i+1);i=Math.max(0,i-o),n=Math.min(t-1,n+o)}return{startPageIndex:i,endPageIndex:n}},EditableGrid.prototype.getPagesInInterval=function(e,t){for(var r=[],i=e.startPageIndex;i<=e.endPageIndex;i++)r.push("function"==typeof t?t(i,i==this.getCurrentPageIndex()):i);return r},CellValidator.prototype.isValid=function(){return!0},NumberCellValidator.prototype=new CellValidator,NumberCellValidator.prototype.isValid=function(e){return isNaN(e)?!1:"integer"==this.type&&""!=e&&parseInt(e)!=parseFloat(e)?!1:!0},EmailCellValidator.prototype=new CellValidator,EmailCellValidator.prototype.isValid=function(e){return""==e||/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)},WebsiteCellValidator.prototype=new CellValidator,WebsiteCellValidator.prototype.isValid=function(e){return""==e||e.indexOf(".")>0&&e.indexOf(".")<e.length-2},DateCellValidator.prototype=new CellValidator,DateCellValidator.prototype.isValid=function(e){return""==e||"object"==typeof this.grid.checkDate(e)},CellRenderer.prototype.init=function(e){for(var t in e)this[t]=e[t]},CellRenderer.prototype._render=function(e,t,r,i){for(r.rowIndex=e,r.columnIndex=t;r.hasChildNodes();)r.removeChild(r.firstChild);return r.isEditing=!1,this.column.isNumerical()&&EditableGrid.prototype.addClassName(r,"number"),"boolean"==this.column.datatype&&EditableGrid.prototype.addClassName(r,"boolean"),EditableGrid.prototype.addClassName(r,"editablegrid-"+this.column.name),r.setAttribute("data-title",this.column.label),this.render(r,"string"==typeof i&&"html"!=this.column.datatype?null===i?null:htmlspecialchars(i,"ENT_NOQUOTES").replace(/  /g," &nbsp;"):i)},CellRenderer.prototype.render=function(e,t,r){var i=r&&"string"==typeof t&&"html"!=this.column.datatype?null===t?null:htmlspecialchars(t,"ENT_NOQUOTES").replace(/  /g," &nbsp;"):t;e.innerHTML=i?i:""},CellRenderer.prototype.getDisplayValue=function(e,t){return t},EnumCellRenderer.prototype=new CellRenderer,EnumCellRenderer.prototype.getLabel=function(e,t){var r="";if("undefined"!=typeof t){t=t?t:"";var i=this.column.getOptionValuesForRender(e);if(i&&t in i&&(r=i[t]),""==r){var n="number"==typeof t&&isNaN(t);r=n?"":t}}return r},EnumCellRenderer.prototype.render=function(e,t){var r=this.getLabel(e.rowIndex,t);e.innerHTML=r?"html"!=this.column.datatype?htmlspecialchars(r,"ENT_NOQUOTES").replace(/\s\s/g,"&nbsp; "):r:""},EnumCellRenderer.prototype.getDisplayValue=function(e,t){return null===t?null:this.getLabel(e,t)},NumberCellRenderer.prototype=new CellRenderer,NumberCellRenderer.prototype.render=function(e,t){var r=this.column||{},i=null===t||"number"==typeof t&&isNaN(t),n=i?r.nansymbol||"":t;"number"==typeof n&&(null!==r.precision&&(n=number_format(n,r.precision,r.decimal_point,r.thousands_separator)),null!==r.unit&&(n=r.unit_before_number?r.unit+" "+n:n+" "+r.unit)),e.innerHTML=n,i?EditableGrid.prototype.addClassName(e,"nan"):EditableGrid.prototype.removeClassName(e,"nan")},CheckboxCellRenderer.prototype=new CellRenderer,CheckboxCellRenderer.prototype._render=function(e,t,r,i){if(r.firstChild&&("function"!=typeof r.firstChild.getAttribute||"checkbox"!=r.firstChild.getAttribute("type")))for(;r.hasChildNodes();)r.removeChild(r.firstChild);return r.rowIndex=e,r.columnIndex=t,EditableGrid.prototype.addClassName(r,"editablegrid-"+this.column.name),r.setAttribute("data-title",this.column.label),this.render(r,i)},CheckboxCellRenderer.prototype.render=function(e,t){if(t=t&&0!=t&&"false"!=t?!0:!1,e.firstChild)return void(e.firstChild.checked=t);var r=document.createElement("input");r.setAttribute("type","checkbox"),r.element=e,r.cellrenderer=this;var i=new CellEditor;i.editablegrid=this.editablegrid,i.column=this.column,r.onclick=function(){e.rowIndex=this.cellrenderer.editablegrid.getRowIndex(e.parentNode),e.isEditing=!0,i.applyEditing(e,r.checked?!0:!1)},e.appendChild(r),r.checked=t,r.disabled=!this.column.editable||!this.editablegrid.isEditable(e.rowIndex,e.columnIndex),EditableGrid.prototype.addClassName(e,"boolean")},EmailCellRenderer.prototype=new CellRenderer,EmailCellRenderer.prototype.render=function(e,t){e.innerHTML=t?"<a href='mailto:"+t+"'>"+t+"</a>":""},WebsiteCellRenderer.prototype=new CellRenderer,WebsiteCellRenderer.prototype.render=function(e,t){e.innerHTML=t?"<a href='"+(-1==t.indexOf("//")?"http://"+t:t)+"'>"+t+"</a>":""},DateCellRenderer.prototype=new CellRenderer,DateCellRenderer.prototype.render=function(e,t){var r=this.editablegrid.checkDate(t);e.innerHTML="object"==typeof r?r.formattedDate:t,e.style.whiteSpace="nowrap"},SortHeaderRenderer.prototype=new CellRenderer,SortHeaderRenderer.prototype.render=function(cell,value){if(value){var link=document.createElement("a");cell.appendChild(link),link.columnName=this.columnName,link.style.cursor="pointer",link.innerHTML=value,link.editablegrid=this.editablegrid,link.renderer=this,link.onclick=function(){with(this.editablegrid){var clearPrevious=(tHead.rows[0].cells,-1),backOnFirstPage=!1;sortedColumnName!=this.columnName?(clearPrevious=sortedColumnName,sortedColumnName=this.columnName,sortDescending=!1,backOnFirstPage=!0):sortDescending?(clearPrevious=sortedColumnName,sortedColumnName=-1,sortDescending=!1,backOnFirstPage=!0):sortDescending=!0,sort(sortedColumnName,sortDescending,backOnFirstPage)}},this.editablegrid.sortedColumnName==this.columnName&&(cell.appendChild(document.createTextNode(" ")),cell.appendChild(this.editablegrid.sortDescending?this.editablegrid.sortDownImage:this.editablegrid.sortUpImage)),this.cellRenderer&&this.cellRenderer.render(cell,value)}else this.cellRenderer&&this.cellRenderer.render(cell,value)},CellEditor.prototype.init=function(e){if(e)for(var t in e)this[t]=e[t]},CellEditor.prototype.edit=function(e,t,r,i){r.isEditing=!0,r.rowIndex=e,r.columnIndex=t;var n=this.getEditor(r,i);return n?(n.element=r,n.celleditor=this,n.onkeydown=function(e){if(e=e||window.event,13==e.keyCode||9==e.keyCode){if(this.onblur_backup=this.onblur,this.onblur=null,this.celleditor.applyEditing(this.element,this.celleditor.getEditorValue(this))===!1&&(this.onblur=this.onblur_backup),9==e.keyCode&&this.element.rowIndex>=0&&this.celleditor.editablegrid.getColumnCount()>0&&this.celleditor.editablegrid.getRowCount()>0)for(var t=this.element.rowIndex,r=this.element.columnIndex;;){r<this.celleditor.editablegrid.getColumnCount()-1?r++:(t++,r=0),this.celleditor.editablegrid.getRow(t)||(t=0);var i=this.celleditor.editablegrid.getColumn(r);if(i.editable&&"boolean"!=i.datatype&&this.celleditor.editablegrid.isEditable(t,r)){this.celleditor.editablegrid.editCell(t,r);break}if(t==this.element.rowIndex&&r==this.element.columnIndex)break}return!1}return 27==e.keyCode?(this.onblur=null,this.celleditor.cancelEditing(this.element),!1):void 0},this.editablegrid.allowSimultaneousEdition||(n.onblur=this.editablegrid.saveOnBlur?function(){this.onblur_backup=this.onblur,this.onblur=null,this.celleditor.applyEditing(this.element,this.celleditor.getEditorValue(this))===!1&&(this.onblur=this.onblur_backup)}:function(){this.onblur=null,this.celleditor.cancelEditing(this.element)}),this.displayEditor(r,n),void n.focus()):!1},CellEditor.prototype.getEditor=function(){return null},CellEditor.prototype.getEditorValue=function(e){return e.value},CellEditor.prototype.formatValue=function(e){return e},CellEditor.prototype.displayEditor=function(e,t,r,i){if(t.style.fontFamily=this.editablegrid.getStyle(e,"fontFamily","font-family"),t.style.fontSize=this.editablegrid.getStyle(e,"fontSize","font-size"),"static"==this.editablegrid.editmode){for(;e.hasChildNodes();)e.removeChild(e.firstChild);e.appendChild(t)}if("absolute"==this.editablegrid.editmode){e.appendChild(t),t.style.position="absolute";var n=this.editablegrid.paddingLeft(e),o=this.editablegrid.paddingTop(e),l=this.editablegrid.getScrollXOffset(e),a=this.editablegrid.getScrollYOffset(e),d="middle"==this.editablegrid.verticalAlign(e)?(e.offsetHeight-t.offsetHeight)/2-o:0;if(t.style.left=this.editablegrid.getCellX(e)-l+n+(r?r:0)+"px",t.style.top=this.editablegrid.getCellY(e)-a+o+d+(i?i:0)+"px","integer"==this.column.datatype||"double"==this.column.datatype){var s=this.editablegrid.getCellX(e)-l+e.offsetWidth-(parseInt(t.style.left)+t.offsetWidth);t.style.left=parseInt(t.style.left)+s+"px",t.style.textAlign="right"}}if("fixed"==this.editablegrid.editmode){for(var u=_$(this.editablegrid.editorzoneid);u.hasChildNodes();)u.removeChild(u.firstChild);u.appendChild(t)}},CellEditor.prototype._clearEditor=function(e){if(e.isEditing=!1,"fixed"==this.editablegrid.editmode)for(var t=_$(this.editablegrid.editorzoneid);t.hasChildNodes();)t.removeChild(t.firstChild)},CellEditor.prototype.cancelEditing=function(element){with(this)if(element&&element.isEditing){var renderer=this==column.headerEditor?column.headerRenderer:column.cellRenderer;renderer._render(element.rowIndex,element.columnIndex,element,editablegrid.getValueAt(element.rowIndex,element.columnIndex)),_clearEditor(element)}},CellEditor.prototype.applyEditing=function(element,newValue){with(this){if(element&&element.isEditing){if(!column.isValid(newValue))return!1;var formattedValue=formatValue(newValue),previousValue=editablegrid.setValueAt(element.rowIndex,element.columnIndex,formattedValue),newValue=editablegrid.getValueAt(element.rowIndex,element.columnIndex);return this.editablegrid.isSame(newValue,previousValue)||editablegrid.modelChanged(element.rowIndex,element.columnIndex,previousValue,newValue,editablegrid.getRow(element.rowIndex)),_clearEditor(element),!0}return!1}},TextCellEditor.prototype=new CellEditor,TextCellEditor.prototype.fieldSize=-1,TextCellEditor.prototype.maxLength=-1,TextCellEditor.prototype.autoHeight=!0,TextCellEditor.prototype.editorValue=function(e){return e},TextCellEditor.prototype.updateStyle=function(e){this.column.isValid(this.getEditorValue(e))?this.editablegrid.removeClassName(e,this.editablegrid.invalidClassName):this.editablegrid.addClassName(e,this.editablegrid.invalidClassName)},TextCellEditor.prototype.getEditor=function(e,t){var r=document.createElement("input");r.setAttribute("type","text"),this.maxLength>0&&r.setAttribute("maxlength",this.maxLength),this.fieldSize>0?r.setAttribute("size",this.fieldSize):r.style.width=this.editablegrid.autoWidth(e)+"px";var i=this.editablegrid.autoHeight(e);return this.autoHeight&&(r.style.height=i+"px"),r.value=this.editorValue(t),r.onkeyup=function(){this.celleditor.updateStyle(this)},r},TextCellEditor.prototype.displayEditor=function(e,t){CellEditor.prototype.displayEditor.call(this,e,t,-1*this.editablegrid.borderLeft(t),-1*(this.editablegrid.borderTop(t)+1)),this.updateStyle(t),t.select()},NumberCellEditor.prototype=new TextCellEditor(-1,32),NumberCellEditor.prototype.editorValue=function(e){return null===e||isNaN(e)?"":(e+"").replace(".",this.column.decimal_point)},NumberCellEditor.prototype.getEditorValue=function(e){return e.value.replace(",",".")},NumberCellEditor.prototype.formatValue=function(e){return"integer"==this.type?parseInt(e):parseFloat(e)},SelectCellEditor.prototype=new CellEditor,SelectCellEditor.prototype.isValueSelected=function(e,t,r){return!t&&!r||t==r},SelectCellEditor.prototype.getEditor=function(e,t){var r=document.createElement("select");this.adaptWidth&&(r.style.width=Math.max(this.minWidth,this.editablegrid.autoWidth(e))+"px"),this.adaptHeight&&"undefined"==typeof jQuery.fn.select2&&(r.style.height=Math.max(this.minHeight,this.editablegrid.autoHeight(e))+"px");for(var i=this.column.getOptionValuesForEdit(e.rowIndex),n=0,o=!1,l=0;l<i.length;l++){var a=i[l];if("object"==typeof a.values){var d=document.createElement("optgroup");d.label=a.label,r.appendChild(d);for(var s=0;s<a.values.length;s++){var u=a.values[s],c=document.createElement("option");c.text=u.label,c.value=u.value?u.value:"",d.appendChild(c),this.isValueSelected(r,u.value,t)?(c.selected=!0,o=!0):c.selected=!1,n++}}else{var c=document.createElement("option");c.text=a.label,c.value=a.value?a.value:"";try{r.add(c,null)}catch(p){r.add(c)}this.isValueSelected(r,a.value,t)?(c.selected=!0,o=!0):c.selected=!1,n++}}if(!o){var c=document.createElement("option");c.text=t?t:"",c.value=t?t:"";try{r.add(c,r.options[0])}catch(p){r.add(c)}r.selectedIndex=0}return r.onchange=function(){this.onblur=null,this.celleditor.applyEditing(this.element,this.value)},r},SelectCellEditor.prototype.displayEditor=function(e,t){CellEditor.prototype.displayEditor.call(this,e,t),"undefined"!=typeof jQuery.fn.select2&&(jQuery(t).select2({dropdownAutoWidth:!0,minimumResultsForSearch:10}).select2("open"),jQuery(t).on("select2-blur",function(){this.onblur&&this.onblur()}).on("select2-close",function(){this.onblur&&this.onblur()}))},SelectCellEditor.prototype.cancelEditing=function(e){"undefined"!=typeof jQuery.fn.select2&&jQuery(e).find("select").select2("destroy"),CellEditor.prototype.cancelEditing.call(this,e)},DateCellEditor.prototype=new TextCellEditor,DateCellEditor.prototype.displayEditor=function(e,t){TextCellEditor.prototype.displayEditor.call(this,e,t),jQuery(t).datepicker({dateFormat:"EU"==this.editablegrid.dateFormat?"dd/mm/yy":"mm/dd/yy",changeMonth:!0,changeYear:!0,yearRange:"c-100:c+10",beforeShow:function(){this.onblur_backup=this.onblur,this.onblur=null},onClose:function(e){""!=e?this.celleditor.applyEditing(t.element,e):null!=this.onblur_backup&&this.onblur_backup()}}).datepicker("show")},EditableGrid.prototype._convertOptions=function(e){if(null!==e&&!(e instanceof Array)&&"object"==typeof e){var t=[];for(var r in e)t.push("object"==typeof e[r]?{label:r,values:this._convertOptions(e[r])}:{value:r,label:e[r]});e=t}return e},EditableGrid.prototype.setCookie=function(e,t,r){var i=new Date;i.setDate(i.getDate()+r);var n=escape(t)+(null==r?"":"; expires="+i.toUTCString());document.cookie=e+"="+n},EditableGrid.prototype.getCookie=function(e){for(var t=document.cookie.split(";"),r=0;r<t.length;r++){var i=t[r].substr(0,t[r].indexOf("=")),n=t[r].substr(t[r].indexOf("=")+1);if(i=i.replace(/^\s+|\s+$/g,""),i==e)return unescape(n)}return null},EditableGrid.prototype.has_local_storage=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}},EditableGrid.prototype._localset=function(e,t){this.has_local_storage()?localStorage.setItem(e,t):this.setCookie(e,t,null)},EditableGrid.prototype._localunset=function(e){this.has_local_storage()?localStorage.removeItem(e):this.setCookie(e,null,null)},EditableGrid.prototype._localget=function(e){return this.has_local_storage()?localStorage.getItem(e):this.getCookie(e)},EditableGrid.prototype._localisset=function(e){return this.has_local_storage()?null!==localStorage.getItem(e)&&"undefined"!=localStorage.getItem(e):null!==this.getCookie(e)},EditableGrid.prototype.localset=function(e,t){return this.enableStore?this._localset(this.name+"_"+e,t):void 0},EditableGrid.prototype.localunset=function(e){return this.enableStore?this._localunset(this.name+"_"+e,value):void 0},EditableGrid.prototype.localget=function(e){return this.enableStore?this._localget(this.name+"_"+e):null},EditableGrid.prototype.localisset=function(e){return this.enableStore?null!==this._localget(this.name+"_"+e):!1},EditableGrid.prototype.unsort=function(e,t){return aa=isNaN(e[2])?0:parseFloat(e[2]),bb=isNaN(t[2])?0:parseFloat(t[2]),aa-bb},EditableGrid.prototype.sort_stable=function(e,t){return function(r,i){var n=t?e(i,r):e(r,i);return 0!=n?n:EditableGrid.prototype.unsort(r,i)}},EditableGrid.prototype.sort_numeric=function(e,t){return aa=isNaN(parseFloat(e[0]))?0:parseFloat(e[0]),bb=isNaN(parseFloat(t[0]))?0:parseFloat(t[0]),aa-bb},EditableGrid.prototype.sort_boolean=function(e,t){return aa=e[0]&&"false"!=e[0]?1:0,bb=t[0]&&"false"!=t[0]?1:0,aa-bb},EditableGrid.prototype.sort_alpha=function(e,t){return e[0].toLowerCase()==t[0].toLowerCase()?0:e[0].toLowerCase().localeCompare(t[0].toLowerCase())},EditableGrid.prototype.sort_date=function(e,t){return date=EditableGrid.prototype.checkDate(e[0]),aa="object"==typeof date?date.sortDate:0,date=EditableGrid.prototype.checkDate(t[0]),bb="object"==typeof date?date.sortDate:0,aa-bb},EditableGrid.prototype.getStyle=function(e,t,r){return r=r||t,e.currentStyle?e.currentStyle[t]:window.getComputedStyle?document.defaultView.getComputedStyle(e,null).getPropertyValue(r):e.style[t]},EditableGrid.prototype.isStatic=function(e){var t=this.getStyle(e,"position");return!t||"static"==t},EditableGrid.prototype.verticalAlign=function(e){return this.getStyle(e,"verticalAlign","vertical-align")},EditableGrid.prototype.paddingLeft=function(e){var t=parseInt(this.getStyle(e,"paddingLeft","padding-left"));return isNaN(t)?0:Math.max(0,t)},EditableGrid.prototype.paddingRight=function(e){var t=parseInt(this.getStyle(e,"paddingRight","padding-right"));return isNaN(t)?0:Math.max(0,t)},EditableGrid.prototype.paddingTop=function(e){var t=parseInt(this.getStyle(e,"paddingTop","padding-top"));return isNaN(t)?0:Math.max(0,t)},EditableGrid.prototype.paddingBottom=function(e){var t=parseInt(this.getStyle(e,"paddingBottom","padding-bottom"));return isNaN(t)?0:Math.max(0,t)},EditableGrid.prototype.borderLeft=function(e){var t=parseInt(this.getStyle(e,"borderRightWidth","border-right-width")),r=parseInt(this.getStyle(e,"borderLeftWidth","border-left-width"));return t=isNaN(t)?0:t,r=isNaN(r)?0:r,Math.max(t,r)},EditableGrid.prototype.borderRight=function(e){return this.borderLeft(e)},EditableGrid.prototype.borderTop=function(e){var t=parseInt(this.getStyle(e,"borderTopWidth","border-top-width")),r=parseInt(this.getStyle(e,"borderBottomWidth","border-bottom-width"));return t=isNaN(t)?0:t,r=isNaN(r)?0:r,Math.max(t,r)},EditableGrid.prototype.borderBottom=function(e){return this.borderTop(e)},EditableGrid.prototype.autoWidth=function(e){return e.offsetWidth-this.paddingLeft(e)-this.paddingRight(e)-this.borderLeft(e)-this.borderRight(e)},EditableGrid.prototype.autoHeight=function(e){return e.offsetHeight-this.paddingTop(e)-this.paddingBottom(e)-this.borderTop(e)-this.borderBottom(e)},EditableGrid.prototype.detectDir=function(){for(var e=location.href,t=document.getElementsByTagName("base"),r=0;r<t.length;r++)t[r].href&&(e=t[r].href);for(var t=document.getElementsByTagName("script"),r=0;r<t.length;r++)if(t[r].src&&/(^|\/)editablegrid[^\/]*\.js([?#].*)?$/i.test(t[r].src)){var i=new URI(t[r].src),n=i.toAbsolute(e);return n.path=n.path.replace(/[^\/]+$/,""),n.path=n.path.replace(/\/$/,""),delete n.query,delete n.fragment,n.toString()}return!1},EditableGrid.prototype.isSame=function(e,t){return e===t?!0:"number"==typeof e&&isNaN(e)&&"number"==typeof t&&isNaN(t)?!0:""===e&&null===t?!0:""===t&&null===e?!0:!1},EditableGrid.prototype.strip=function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},EditableGrid.prototype.hasClassName=function(e,t){return e.className.length>0&&(e.className==t||new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className))},EditableGrid.prototype.addClassName=function(e,t){this.hasClassName(e,t)||(e.className+=(e.className?" ":"")+t)},EditableGrid.prototype.removeClassName=function(e,t){e.className=this.strip(e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," "))},String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")},String.prototype.contains=function(e){return this.match(e)==e},String.prototype.startsWith=function(e){return this.match("^"+e)==e},String.prototype.endsWith=function(e){return this.match(e+"$")==e},EditableGrid.prototype.checkDate=function(e,t){t=t||this.dateFormat,t=t||"EU";var e,r,n,o,l,a,d,s,u,c=!1,p=new Array("-"," ","/","."),h=this.shortMonthNames;if(h=h||["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],!e||e.length<1)return 0;for(u=0;u<p.length;u++)if(-1!=e.indexOf(p[u])){if(r=e.split(p[u]),3!=r.length)return 1;n=r[0],o=r[1],l=r[2],c=!0}if(0==c){if(e.length<=5)return 1;n=e.substr(0,2),o=e.substr(2,2),l=e.substr(4)}if("US"==t&&(strTemp=n,n=o,o=strTemp),a=parseInt(n,10),isNaN(a))return 2;if(d=parseInt(o,10),isNaN(d)){for(i=0;12>i;i++)o.toUpperCase()==h[i].toUpperCase()&&(d=i+1,o=h[i],i=12);if(isNaN(d))return 3}if(d>12||1>d)return 5;if(s=parseInt(l,10),isNaN(s))return 4;if(70>s&&(s=2e3+s,l=""+s),100>s&&(s=1900+s,l=""+s),1900>s||s>2100)return 11;if((1==d||3==d||5==d||7==d||8==d||10==d||12==d)&&(a>31||1>a))return 6;if((4==d||6==d||9==d||11==d)&&(a>30||1>a))return 7;if(2==d){if(1>a)return 8;if(1==LeapYear(s)){if(a>29)return 9}else if(a>28)return 10}return{formattedDate:"US"==t?h[d-1]+" "+a+" "+l:a+" "+h[d-1]+" "+l,sortDate:Date.parse(d+"/"+a+"/"+s),dbDate:s+"-"+d+"-"+a}
},URI=function(e){function t(e){for(var t="";e;)if("../"==e.substr(0,3)||"./"==e.substr(0,2))e=e.replace(/^\.+/,"").substr(1);else if("/./"==e.substr(0,3)||"/."==e)e="/"+e.substr(3);else if("/../"==e.substr(0,4)||"/.."==e)e="/"+e.substr(4),t=t.replace(/\/?[^\/]*$/,"");else if("."==e||".."==e)e="";else{var r=e.match(/^\/?[^\/]*/)[0];e=e.substr(r.length),t+=r}return t}this.scheme=null,this.authority=null,this.path="",this.query=null,this.fragment=null,this.parse=function(e){var t=e.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/);return this.scheme=t[3]?t[2]:null,this.authority=t[5]?t[6]:null,this.path=t[7],this.query=t[9]?t[10]:null,this.fragment=t[12]?t[13]:null,this},this.toString=function(){var e="";return null!=this.scheme&&(e=e+this.scheme+":"),null!=this.authority&&(e=e+"//"+this.authority),null!=this.path&&(e+=this.path),null!=this.query&&(e=e+"?"+this.query),null!=this.fragment&&(e=e+"#"+this.fragment),e},this.toAbsolute=function(e){var e=new URI(e),r=this,i=new URI;return null==e.scheme?!1:(null!=r.scheme&&r.scheme.toLowerCase()==e.scheme.toLowerCase()&&(r.scheme=null),null!=r.scheme?(i.scheme=r.scheme,i.authority=r.authority,i.path=t(r.path),i.query=r.query):(null!=r.authority?(i.authority=r.authority,i.path=t(r.path),i.query=r.query):(""==r.path?(i.path=e.path,i.query=null!=r.query?r.query:e.query):("/"==r.path.substr(0,1)?i.path=t(r.path):(i.path=null!=e.authority&&""==e.path?"/"+r.path:e.path.replace(/[^\/]+$/,"")+r.path,i.path=t(i.path)),i.query=r.query),i.authority=e.authority),i.scheme=e.scheme),i.fragment=r.fragment,i)},e&&this.parse(e)};